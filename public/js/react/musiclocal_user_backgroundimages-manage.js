"use strict";var BackgroundimageContainer=React.createClass({displayName:"BackgroundimageContainer",getInitialState:function getInitialState(){return {data:[]};},componentDidMount:function componentDidMount(){$.ajax({type:"GET",url:"user/ajax/get/get_current_user_backgroundimages_all",data:{ //"projectid": projectid
},error:function error(){$('.photohashasnotbeenadded').finish().hide(0).removeClass('alert-success','alert-info').html('There was an error').addClass('alert-danger').fadeIn(300).removeClass('hidden').delay(3000).fadeOut(300);},success:(function(response){ //console.log(response);
$('.photohashasnotbeenadded').finish().hide(0).removeClass('alert-danger','alert-info').html('Success').addClass('alert-success').fadeIn(300).removeClass('hidden').delay(3000).fadeOut(300);var parsedresponse=JSON.parse(response);var uniqueresponse=parsedresponse.backgroundimages; //var projectresponse = parsedresponse.projectbackgroundimageimages;
//console.log(foo.uniquebackgroundimageimages);
this.setState({data:uniqueresponse}); //renderreact(uniqueresponse, projectresponse);
}).bind(this)});},handleDeleteButton:function handleDeleteButton(childdata){var backgroundimageid=childdata.bid;var imagesrc=childdata.filename;var tempstatedata=this.state.data;var setstatefunction=(function(){var newdataarray=this.state.data;var elementPos=this.state.data.map(function(item){return item.backgroundimage_id;}).indexOf(backgroundimageid);newdataarray.splice(elementPos,1);this.setState({data:newdataarray}); //this does not seem to work (state is set correctly w/ item removed but component does not re-render even with forceUpdate.
//hiding component instead
$('#backgroundimage-' + backgroundimageid).hide();}).bind(this);var r=confirm("Are you sure you want to delete this background image? This will remove the background image from all MusicLocal projects. WARNING: this action cannot be undone.");if(r == true){setstatefunction();$.ajax({type:"POST",url:"user/ajax/post/user_backgroundimagedelete", //dataType: "text"
data:{"backgroundimageimage_id":backgroundimageid,"backgroundimageimage_filename":imagesrc,_token:$_token},error:(function(){$('.photohashasnotbeenadded').finish().hide(0).removeClass('alert-success','alert-info').html('There was an error').addClass('alert-danger').fadeIn(300).removeClass('hidden').delay(3000).fadeOut(300);this.setState({data:tempstatedata});$('#backgroundimage-' + backgroundimageid).show();}).bind(this),success:(function(response){$('.photohashasnotbeenadded').finish().hide(0).removeClass('alert-danger','alert-info').html('Success').addClass('alert-success').fadeIn(300).removeClass('hidden').delay(3000).fadeOut(300);ReactDOM.unmountComponentAtNode(document.getElementById('content-modal'));$('#content-main').show();}).bind(this)});}},render:function render(){var containerstyle={padding:0}; //
return React.createElement("div",{className:"",style:containerstyle,id:"backgroundimages-manage-container"},React.createElement("div",{id:"fbphotodisplay",ref:"fbphotodisplay"},React.createElement(BackgroundimageList,{data:this.state.data,handleDeleteButton:this.handleDeleteButton})));}});var BackgroundimageList=React.createClass({displayName:"BackgroundimageList",handleDeleteButton:function handleDeleteButton(data){this.props.handleDeleteButton(data);},render:function render(){var backgroundimages=this.props.data.map((function(backgroundimage){return React.createElement(CurrentBackgroundimage,{filename:backgroundimage.backgroundimage_filename,key:backgroundimage.backgroundimage_id,id:backgroundimage.backgroundimage_id,onBackgroundimageAddClick:this.handleIntermediate,handleDeleteButton:this.handleDeleteButton});}).bind(this));var imgcontstyle={};return React.createElement("div",{id:"get-user-photos-from-facebook"},React.createElement("div",{id:"fbphotoscrollcontainer",ref:"fbphotoscrollcontainer",style:imgcontstyle},backgroundimages));}});var CurrentBackgroundimage=React.createClass({displayName:"CurrentBackgroundimage",getInitialState:function getInitialState(){return {showComponent:true};},componentDidMount:function componentDidMount(){},handleModalDeleteButton:function handleModalDeleteButton(data){this.props.handleDeleteButton(data);},handleDeleteButton:function handleDeleteButton(){this.props.handleDeleteButton({bid:this.props.id,filename:this.props.filename});},onClick:function onClick(){ReactDOM.unmountComponentAtNode(document.getElementById('content-modal'));ReactDOM.render(React.createElement(BackgroundimageModal,{filename:this.props.filename,id:this.props.id,key:'modal' + this.props.id,handleDeleteButton:this.handleModalDeleteButton}),document.getElementById('content-modal'));$('#content-main').hide();$('#savecurrentbackgroundimagebutton').attr('href','//d1y0bevpkkhybk.cloudfront.net/c/' + this.props.filename + '.jpg');},render:function render(){if(!this.state.showComponent){return null;}var photostyle={padding:'0.25%'};var name=this.props.filename; //console.log(name);
var srcstring='//d1y0bevpkkhybk.cloudfront.net/bxs/' + name + '.jpg';var btndivstyle={textAlign:'center'};var btnstyle={marginTop:6,marginBottom:12};var idstring='backgroundimage-' + this.props.id;return  (//<img className="grid-item grid-item--width3" style={photostyle} onClick={this.onClick} src={this.props.link3} data-link0={this.props.link0} data-link1={this.props.link1} data-link2={this.props.link2} data-link4={this.props.link4} data-link5={this.props.link5} data-link6={this.props.link6} id={this.props.id} data-fromid={this.props.from_id} data-from_name={this.props.from_name} data-fb_created_time={this.props.fb_created_time}/>
React.createElement("div",{className:"col-sm-4 col-xs-12",id:idstring},React.createElement("a",{onClick:this.onClick},React.createElement("img",{className:"img img-responsive",id:this.props.id,"data-id":this.props.id,style:photostyle,src:srcstring})),React.createElement("div",{style:btndivstyle},React.createElement("a",{className:"btn btn-block btn-primary",onClick:this.onClick},"View Larger Background Image")),React.createElement("div",{style:btndivstyle},React.createElement("a",{className:"btn btn-block btn-warning",onClick:this.handleDeleteButton},"Delete Background Image")),React.createElement("br",null)));}});var BackgroundimageModal=React.createClass({displayName:"BackgroundimageModal",getInitialState:function getInitialState(){return {showComponent:true};},componentDidMount:function componentDidMount(){var image=new Image();image.addEventListener("load",function(){var w=image.width;var h=image.height;var h_dividedby_w=h / w;console.log('w: ' + w + '; h: ' + h + '; h_dividedby_w: ' + h_dividedby_w);var modal_top_position=document.getElementById("content-modal").offsetTop;var window_height=window.innerHeight;var modal_button_container_height=document.getElementById("modal-button-container").offsetHeight;var set_modal_image_height=window_height - modal_top_position - modal_button_container_height - 60;var set_modal_image_width=set_modal_image_height / h_dividedby_w;$("#currentmodalbackgroundimage").css({"height":set_modal_image_height,"width":set_modal_image_width});});image.src = '//d1y0bevpkkhybk.cloudfront.net/b/' + this.props.filename + '.jpg';},handleClose:function handleClose(){ReactDOM.unmountComponentAtNode(document.getElementById('content-modal'));$('#content-main').show();},handleDeleteButton:function handleDeleteButton(){this.props.handleDeleteButton({bid:this.props.id,filename:this.props.filename});},render:function render(){var srcstring='//d1y0bevpkkhybk.cloudfront.net/b/' + this.props.filename + '.jpg';var spacerstyle={padding:10};var textdivstyle={display:'block',textAlign:'center'};var modal_container_style={textAlign:'center'};var modal_img_style={display:'block',margin:'0 auto'};return React.createElement("div",{className:"col-xs-12",id:"modal-container",style:modal_container_style},React.createElement("img",{className:"img img-responsive",src:srcstring,id:"currentmodalbackgroundimage",style:modal_img_style}),React.createElement("div",{style:textdivstyle,id:"modal-button-container"},React.createElement("br",null),React.createElement("p",null,React.createElement("em",null,"To copy the link to your background image, right click on the background image and select \"Copy image URL.\"")),React.createElement("br",null),React.createElement("a",{id:"savecurrentbackgroundimagebutton",href:"",download:true,className:"btn btn-primary"},"Save Background Image"),React.createElement("span",{style:spacerstyle}),React.createElement("a",{id:"deletecurrentbackgroundimagebutton",className:"btn btn-default",onClick:this.handleDeleteButton},"Delete Background Image"),React.createElement("br",null),React.createElement("br",null),React.createElement("div",null,React.createElement("a",{id:"closebox",className:"btn btn-default",onClick:this.handleClose},"Close Background Image"))));}});